---
import { reshapeData } from "src/utils/utils";

const baseURL = "http://localhost:4321";
const data = await fetch(new URL(`api/data/indices.json`, baseURL));
const parsed = await data.json();

const reshapedData = reshapeData(parsed);
---

<style lang="scss">
  .pollutants-table {
    width: 100%;

    th,
    td {
      padding: 0.3rem;
      font-size: 12px;
      text-align: center;
      word-break: break-word;
    }
  }

  @media (max-width: 600px) {
    .pollutants-table {
      .table-headings {
        font-size: 10px;
      }

      th,
      td {
        padding: 0.1rem;
        font-size: 10px;
      }
    }
  }
</style>

<div class="pollutants-table__wrapper">
  <table class="pollutants-table">
    <thead>
      <tr>
        {
          Object.keys(reshapedData[0]).map((key) => (
            <th class="table-headings">{key === "country" ? "" : key}</th>
          ))
        }
      </tr>
    </thead>
    <tbody>
      {
        reshapedData.map((row) => (
          <tr>
            {Object.entries(row).map(([key, value]) => (
              <td>{key === "country" ? value : value ? "✅" : "❌"}</td>
            ))}
          </tr>
        ))
      }
    </tbody>
  </table>
</div>
