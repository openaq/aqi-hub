---
import ColorScaleChart from "./ColorScaleChart.astro";
import { colorScaleReshape } from "../utils/utils";
import type { ColorScaleDefinition } from "src/types/types";

const { colorScaleValues, index, value } = Astro.props;

let colorScale: ColorScaleDefinition[] = [];

if (colorScaleValues) {
  colorScale = colorScaleValues;
} else if (index) {
  const res = await fetch(new URL(`api/data/${index}.json`, Astro.site?.href));
  const parsed = await res.json();
  colorScale = colorScaleReshape(parsed, value);
}
---

<ColorScaleChart colorScale={colorScale} />
